## Некоторые фичи задания на 2022 год и указания
### Часть 1
Слушайте внимательно семинар. Из года в год меняются поля, которые надо выводить - в 2022 году нужно было к пиду и названию вывести еще приоритет и state  
* current обязательно **не в цикле**
* перичисления полей в printk **одной строкой**

Не забываем менять MODULE_AUTHOR :)
Много очень комментариев. Код не понравился 

Загружаем модуль:
```
sudo insmod main.ko
```

Посмотреть вывод в журнале:
```
dmesg | grep +
```

Выгружаем модуль:
```
sudo rmmod main.ko
```
### Часть 2
Цитата:  
*материал посвящен ВЗАИМОДЕЙСТВИЯМ МОДУЛЕЙ ЯДРА*  


Значит, один модуль может использовать данные и функции, используемые в другом модуле.  
Цель этой части - получить соответствующие ошибки. 

**ВАЖНО**

*Модуль md2, использующий экспортируемое имя, связывается с этим именем по прямому абсолютному адресу.*  
Комментарий от Н:  
*Слово "прямой" здесь лишнее. Главное, что такое абсолютный адрес* 

Дальше по Цирюлику.  
1. Пробуем загрузить cначала только md2:
```
$ sudo insmod md2.ko
insmod: ERROR: could not insert module md2.ko: Unknown symbol in module
```
В журнале:
```
$ dmesg
[ 6987.204306] md2: Unknown symbol md1_data (err -2)
[ 6987.204337] md2: Unknown symbol md1_proc (err -2)
```
2. Теперь в правильном порядке:
```
$ sudo insmod md1.ko
$ sudo insmod md2.ko
$ lsmod | head -1 && lsmod | grep md
Module                  Size  Used by
md2                    16384  0
md1                    16384  1 md2
```
на модуль md1 ссылается некоторые другие модули или объекты ядра: цифра 1 — это число таких ссылающихся модулей, которое называется счётчиком ссылок.


3. Пытаемся выгрузить:
```
$ sudo rmmod md1
rmmod: ERROR: Module md1 is in use by: md2
```
до тех пор, пока число ссылок на любой модуль в системе не станет нулевым, модуль не может быть выгружен.

```
$ sudo rmmod md2
$ sudo rmmod md1
$ lsmod | head -1 && lsmod | grep md
Module                  Size  Used by
```
4. Пытаемся загрузить md3 (перед этим опять надо загрузить md1 и md2 для нужного сообщения об ошибке)
```
$ sudo insmod md3.ko
insmod: ERROR: could not insert module md3.ko: Operation not permitted
```

----
Очистить dmesg можно следующей командой:
```
sudo dmesg -c
```
Посмотреть загруженные модули:
```
lsmod
```